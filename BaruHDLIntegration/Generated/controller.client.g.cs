// <auto-generated>
//     Generated by ProtoPocoGen. Do not edit.
// </auto-generated>

#nullable enable

using System;
using System.Net.Http;
using System.Text;
using System.Text.Json;
using System.Text.Json.Serialization;
using System.Threading;
using System.Threading.Tasks;

using Headless.Rpc;

namespace Hdlctrl.V1;

/// <summary>
/// Auto-generated client for ControllerService
/// </summary>
public class ControllerServiceClient
{
    public const string ServiceName = "hdlctrl.v1.ControllerService";

    protected readonly HttpClient _httpClient;
    protected readonly string _baseAddress;
    protected readonly JsonSerializerOptions _jsonOptions;

    public ControllerServiceClient(HttpClient httpClient, string baseAddress, JsonSerializerOptions? jsonOptions = null)
    {
        _httpClient = httpClient;
        _baseAddress = baseAddress.TrimEnd('/');
        _jsonOptions = jsonOptions ?? CreateDefaultJsonOptions();
    }

    private static JsonSerializerOptions CreateDefaultJsonOptions() => new()
    {
        PropertyNamingPolicy = JsonNamingPolicy.CamelCase,
        DefaultIgnoreCondition = JsonIgnoreCondition.WhenWritingNull
    };

    /// <summary>
    /// Called before sending a request. Override to add authentication headers, etc.
    /// </summary>
    protected virtual void ConfigureRequest(HttpRequestMessage request) { }

    /// <summary>
    /// Called when a request fails. Return true to retry the request.
    /// </summary>
    /// <param name="response">The failed response</param>
    /// <param name="retryCount">Current retry count (starts at 0)</param>
    /// <param name="cancellationToken">Cancellation token</param>
    /// <returns>True to retry, false to throw</returns>
    protected virtual Task<bool> OnRequestFailedAsync(
        HttpResponseMessage response,
        int retryCount,
        CancellationToken cancellationToken)
    {
        return Task.FromResult(false);
    }

    protected virtual async Task<TResponse> RequestAsync<TRequest, TResponse>(
        string rpcName,
        TRequest request,
        CancellationToken cancellationToken = default)
    {
        var retryCount = 0;
        while (true)
        {
            var json = JsonSerializer.Serialize(request, _jsonOptions);
            var httpRequest = new HttpRequestMessage(HttpMethod.Post,
                $"{_baseAddress}/{ServiceName}/{rpcName}");
            httpRequest.Content = new StringContent(json, Encoding.UTF8, "application/json");

            ConfigureRequest(httpRequest);

            var response = await _httpClient.SendAsync(httpRequest, cancellationToken);

            if (!response.IsSuccessStatusCode)
            {
                if (await OnRequestFailedAsync(response, retryCount, cancellationToken))
                {
                    retryCount++;
                    continue;
                }
            }

            response.EnsureSuccessStatusCode();

            var responseJson = await response.Content.ReadAsStringAsync(cancellationToken);
            return JsonSerializer.Deserialize<TResponse>(responseJson, _jsonOptions)!;
        }
    }

    public virtual Task<ListHeadlessHostResponse> ListHeadlessHostAsync(
        ListHeadlessHostRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<ListHeadlessHostRequest, ListHeadlessHostResponse>(
            "ListHeadlessHost", request, cancellationToken);
    }

    public virtual Task<GetHeadlessHostResponse> GetHeadlessHostAsync(
        GetHeadlessHostRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<GetHeadlessHostRequest, GetHeadlessHostResponse>(
            "GetHeadlessHost", request, cancellationToken);
    }

    public virtual Task<GetHeadlessHostLogsResponse> GetHeadlessHostLogsAsync(
        GetHeadlessHostLogsRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<GetHeadlessHostLogsRequest, GetHeadlessHostLogsResponse>(
            "GetHeadlessHostLogs", request, cancellationToken);
    }

    public virtual Task<ShutdownHeadlessHostResponse> ShutdownHeadlessHostAsync(
        ShutdownHeadlessHostRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<ShutdownHeadlessHostRequest, ShutdownHeadlessHostResponse>(
            "ShutdownHeadlessHost", request, cancellationToken);
    }

    public virtual Task<KillHeadlessHostResponse> KillHeadlessHostAsync(
        KillHeadlessHostRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<KillHeadlessHostRequest, KillHeadlessHostResponse>(
            "KillHeadlessHost", request, cancellationToken);
    }

    public virtual Task<UpdateHeadlessHostSettingsResponse> UpdateHeadlessHostSettingsAsync(
        UpdateHeadlessHostSettingsRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<UpdateHeadlessHostSettingsRequest, UpdateHeadlessHostSettingsResponse>(
            "UpdateHeadlessHostSettings", request, cancellationToken);
    }

    public virtual Task<RestartHeadlessHostResponse> RestartHeadlessHostAsync(
        RestartHeadlessHostRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<RestartHeadlessHostRequest, RestartHeadlessHostResponse>(
            "RestartHeadlessHost", request, cancellationToken);
    }

    public virtual Task<StartHeadlessHostResponse> StartHeadlessHostAsync(
        StartHeadlessHostRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<StartHeadlessHostRequest, StartHeadlessHostResponse>(
            "StartHeadlessHost", request, cancellationToken);
    }

    public virtual Task<AllowHostAccessResponse> AllowHostAccessAsync(
        AllowHostAccessRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<AllowHostAccessRequest, AllowHostAccessResponse>(
            "AllowHostAccess", request, cancellationToken);
    }

    public virtual Task<DenyHostAccessResponse> DenyHostAccessAsync(
        DenyHostAccessRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<DenyHostAccessRequest, DenyHostAccessResponse>(
            "DenyHostAccess", request, cancellationToken);
    }

    public virtual Task<ListHeadlessHostImageTagsResponse> ListHeadlessHostImageTagsAsync(
        ListHeadlessHostImageTagsRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<ListHeadlessHostImageTagsRequest, ListHeadlessHostImageTagsResponse>(
            "ListHeadlessHostImageTags", request, cancellationToken);
    }

    public virtual Task<DeleteHeadlessHostResponse> DeleteHeadlessHostAsync(
        DeleteHeadlessHostRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<DeleteHeadlessHostRequest, DeleteHeadlessHostResponse>(
            "DeleteHeadlessHost", request, cancellationToken);
    }

    public virtual Task<ListHeadlessHostInstancesResponse> ListHeadlessHostInstancesAsync(
        ListHeadlessHostInstancesRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<ListHeadlessHostInstancesRequest, ListHeadlessHostInstancesResponse>(
            "ListHeadlessHostInstances", request, cancellationToken);
    }

    public virtual Task<CreateHeadlessAccountResponse> CreateHeadlessAccountAsync(
        CreateHeadlessAccountRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<CreateHeadlessAccountRequest, CreateHeadlessAccountResponse>(
            "CreateHeadlessAccount", request, cancellationToken);
    }

    public virtual Task<ListHeadlessAccountsResponse> ListHeadlessAccountsAsync(
        ListHeadlessAccountsRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<ListHeadlessAccountsRequest, ListHeadlessAccountsResponse>(
            "ListHeadlessAccounts", request, cancellationToken);
    }

    public virtual Task<DeleteHeadlessAccountResponse> DeleteHeadlessAccountAsync(
        DeleteHeadlessAccountRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<DeleteHeadlessAccountRequest, DeleteHeadlessAccountResponse>(
            "DeleteHeadlessAccount", request, cancellationToken);
    }

    public virtual Task<UpdateHeadlessAccountCredentialsResponse> UpdateHeadlessAccountCredentialsAsync(
        UpdateHeadlessAccountCredentialsRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<UpdateHeadlessAccountCredentialsRequest, UpdateHeadlessAccountCredentialsResponse>(
            "UpdateHeadlessAccountCredentials", request, cancellationToken);
    }

    public virtual Task<GetHeadlessAccountStorageInfoResponse> GetHeadlessAccountStorageInfoAsync(
        GetHeadlessAccountStorageInfoRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<GetHeadlessAccountStorageInfoRequest, GetHeadlessAccountStorageInfoResponse>(
            "GetHeadlessAccountStorageInfo", request, cancellationToken);
    }

    public virtual Task<RefetchHeadlessAccountInfoResponse> RefetchHeadlessAccountInfoAsync(
        RefetchHeadlessAccountInfoRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<RefetchHeadlessAccountInfoRequest, RefetchHeadlessAccountInfoResponse>(
            "RefetchHeadlessAccountInfo", request, cancellationToken);
    }

    public virtual Task<UpdateHeadlessAccountIconResponse> UpdateHeadlessAccountIconAsync(
        UpdateHeadlessAccountIconRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<UpdateHeadlessAccountIconRequest, UpdateHeadlessAccountIconResponse>(
            "UpdateHeadlessAccountIcon", request, cancellationToken);
    }

    public virtual Task<FetchWorldInfoResponse> FetchWorldInfoAsync(
        FetchWorldInfoRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<FetchWorldInfoRequest, FetchWorldInfoResponse>(
            "FetchWorldInfo", request, cancellationToken);
    }

    public virtual Task<SearchUserInfoResponse> SearchUserInfoAsync(
        SearchUserInfoRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<SearchUserInfoRequest, SearchUserInfoResponse>(
            "SearchUserInfo", request, cancellationToken);
    }

    public virtual Task<SearchWorldsResponse> SearchWorldsAsync(
        SearchWorldsRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<SearchWorldsRequest, SearchWorldsResponse>(
            "SearchWorlds", request, cancellationToken);
    }

    public virtual Task<GetResoniteUserResponse> GetResoniteUserAsync(
        GetResoniteUserRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<GetResoniteUserRequest, GetResoniteUserResponse>(
            "GetResoniteUser", request, cancellationToken);
    }

    public virtual Task<GetFriendRequestsResponse> GetFriendRequestsAsync(
        GetFriendRequestsRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<GetFriendRequestsRequest, GetFriendRequestsResponse>(
            "GetFriendRequests", request, cancellationToken);
    }

    public virtual Task<AcceptFriendRequestsResponse> AcceptFriendRequestsAsync(
        AcceptFriendRequestsRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<AcceptFriendRequestsRequest, AcceptFriendRequestsResponse>(
            "AcceptFriendRequests", request, cancellationToken);
    }

    public virtual Task<ListContactsResponse> ListContactsAsync(
        ListContactsRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<ListContactsRequest, ListContactsResponse>(
            "ListContacts", request, cancellationToken);
    }

    public virtual Task<GetContactMessagesResponse> GetContactMessagesAsync(
        GetContactMessagesRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<GetContactMessagesRequest, GetContactMessagesResponse>(
            "GetContactMessages", request, cancellationToken);
    }

    public virtual Task<SendContactMessageResponse> SendContactMessageAsync(
        SendContactMessageRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<SendContactMessageRequest, SendContactMessageResponse>(
            "SendContactMessage", request, cancellationToken);
    }

    public virtual Task<SearchSessionsResponse> SearchSessionsAsync(
        SearchSessionsRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<SearchSessionsRequest, SearchSessionsResponse>(
            "SearchSessions", request, cancellationToken);
    }

    public virtual Task<GetSessionDetailsResponse> GetSessionDetailsAsync(
        GetSessionDetailsRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<GetSessionDetailsRequest, GetSessionDetailsResponse>(
            "GetSessionDetails", request, cancellationToken);
    }

    public virtual Task<StartWorldResponse> StartWorldAsync(
        StartWorldRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<StartWorldRequest, StartWorldResponse>(
            "StartWorld", request, cancellationToken);
    }

    public virtual Task<StopSessionResponse> StopSessionAsync(
        StopSessionRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<StopSessionRequest, StopSessionResponse>(
            "StopSession", request, cancellationToken);
    }

    public virtual Task<DeleteEndedSessionResponse> DeleteEndedSessionAsync(
        DeleteEndedSessionRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<DeleteEndedSessionRequest, DeleteEndedSessionResponse>(
            "DeleteEndedSession", request, cancellationToken);
    }

    public virtual Task<SaveSessionWorldResponse> SaveSessionWorldAsync(
        SaveSessionWorldRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<SaveSessionWorldRequest, SaveSessionWorldResponse>(
            "SaveSessionWorld", request, cancellationToken);
    }

    public virtual Task<InviteUserResponse> InviteUserAsync(
        InviteUserRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<InviteUserRequest, InviteUserResponse>(
            "InviteUser", request, cancellationToken);
    }

    public virtual Task<UpdateUserRoleResponse> UpdateUserRoleAsync(
        UpdateUserRoleRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<UpdateUserRoleRequest, UpdateUserRoleResponse>(
            "UpdateUserRole", request, cancellationToken);
    }

    public virtual Task<UpdateSessionParametersResponse> UpdateSessionParametersAsync(
        UpdateSessionParametersRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<UpdateSessionParametersRequest, UpdateSessionParametersResponse>(
            "UpdateSessionParameters", request, cancellationToken);
    }

    public virtual Task<UpdateSessionExtraSettingsResponse> UpdateSessionExtraSettingsAsync(
        UpdateSessionExtraSettingsRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<UpdateSessionExtraSettingsRequest, UpdateSessionExtraSettingsResponse>(
            "UpdateSessionExtraSettings", request, cancellationToken);
    }

    public virtual Task<ListUsersInSessionResponse> ListUsersInSessionAsync(
        ListUsersInSessionRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<ListUsersInSessionRequest, ListUsersInSessionResponse>(
            "ListUsersInSession", request, cancellationToken);
    }

    public virtual Task<KickUserResponse> KickUserAsync(
        KickUserRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<KickUserRequest, KickUserResponse>(
            "KickUser", request, cancellationToken);
    }

    public virtual Task<BanUserResponse> BanUserAsync(
        BanUserRequest request,
        CancellationToken cancellationToken = default)
    {
        return RequestAsync<BanUserRequest, BanUserResponse>(
            "BanUser", request, cancellationToken);
    }

}

